<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>現車在庫 | 明德車業 MINGDE MOTOR</title>
    <link rel="stylesheet" href="css/common.css">
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/products.css">
    <link rel="stylesheet" href="css/mobile-menu.css" media="screen and (max-width: 992px)">
</head>
<body>

    <header>
        <div class="nav-container">
            <a href="index.html" class="logo-container">
                <img src="image/logo.jpg" alt="明德車業 Logo" class="logo-img">
            </a>
            <button class="menu-toggle" aria-label="選單">
                <span></span>
                <span></span>
                <span></span>
            </button>
            <nav class="nav-list">
                <a href="index.html">首頁</a>
                <a href="products.html">現車庫存</a>
                <a href="booking-ride.html" class="nav-btn ride">預約試乘</a>
                <a href="booking-service.html" class="nav-btn">保養預約</a>
                <a href="event-signup.html">活動報名</a>
            </nav>
            <div class="overlay"></div>
        </div>
    </header>

    <main style="margin-top: 80px;" class="products-section">
        <div class="section-header">
            <h2>現車在庫</h2>
            <p style="font-size: 1.5rem; color: #666;">即刻入主，開啟你的騎行篇章</p>
        </div>

        <div class="filter-group">
            <button class="filter-btn active" onclick="filterBikes('all', event)">全部展示</button>
            <button class="filter-btn" onclick="filterBikes('kawasaki', event)">KAWASAKI</button>
            <button class="filter-btn" onclick="filterBikes('kymco', event)">KYMCO</button>
            <button class="filter-btn" onclick="filterBikes('used', event)">二手全車款</button>
        </div>

        <!-- 靜態新車展示（川崎、光陽），由管理員手動維護；二手車由下方的動態區塊顯示 -->
        <div class="product-grid" id="newBikeGrid">
            <!-- KAWASAKI 全車款 (常見清單) -->
            <div class="product-card" data-brand="kawasaki">
                <img src="https://via.placeholder.com/800x450?text=Kawasaki+Ninja+400" alt="Kawasaki Ninja 400" class="product-img">
                <div class="product-info">
                    <span class="product-brand">KAWASAKI</span>
                    <h3 class="product-name">Ninja 400</h3>
                    <span class="product-price">售價 195,000 元</span>
                    <div class="product-specs"><span>399 cc</span> | <span>2025</span></div>
                    <a href="booking-ride.html?model=Ninja%20400&brand=KAWASAKI" class="btn-view">預約賞車</a>
                </div>
            </div>

            <div class="product-card" data-brand="kawasaki">
                <img src="https://via.placeholder.com/800x450?text=Kawasaki+Ninja+650" alt="Kawasaki Ninja 650" class="product-img">
                <div class="product-info">
                    <span class="product-brand">KAWASAKI</span>
                    <h3 class="product-name">Ninja 650</h3>
                    <span class="product-price">售價 255,000 元</span>
                    <div class="product-specs"><span>649 cc</span> | <span>2025</span></div>
                    <a href="booking-ride.html?model=Ninja%20650&brand=KAWASAKI" class="btn-view">預約賞車</a>
                </div>
            </div>

            <div class="product-card" data-brand="kawasaki">
                <img src="https://via.placeholder.com/800x450?text=Kawasaki+Z650" alt="Kawasaki Z650" class="product-img">
                <div class="product-info">
                    <span class="product-brand">KAWASAKI</span>
                    <h3 class="product-name">Z650</h3>
                    <span class="product-price">售價 238,000 元</span>
                    <div class="product-specs"><span>649 cc</span> | <span>2025</span></div>
                    <a href="booking-ride.html?model=Z650&brand=KAWASAKI" class="btn-view">預約賞車</a>
                </div>
            </div>

            <div class="product-card" data-brand="kawasaki">
                <img src="https://via.placeholder.com/800x450?text=Kawasaki+Z650" alt="Kawasaki Z650" class="product-img">
                <div class="product-info">
                    <span class="product-brand">KAWASAKI</span>
                    <h3 class="product-name">Z900</h3>
                    <span class="product-price">售價 538,000 元</span>
                    <div class="product-specs"><span>948 cc</span> | <span>2023'2024</span></div>
                    <a href="booking-ride.html?model=Z900&brand=KAWASAKI" class="btn-view">預約賞車</a>
                </div>
            </div>

            <div class="product-card" data-brand="kawasaki">
                <img src="https://via.placeholder.com/800x450?text=Kawasaki+Z650" alt="Kawasaki Z650" class="product-img">
                <div class="product-info">
                    <span class="product-brand">KAWASAKI</span>
                    <h3 class="product-name">Z650RS</h3>
                    <span class="product-price">售價 398,000 元</span>
                    <div class="product-specs"><span>649 cc</span> | <span>2023'2024</span></div>
                    <a href="booking-ride.html?model=Z650RS&brand=KAWASAKI" class="btn-view">預約賞車</a>
                </div>
            </div>

            <div class="product-card" data-brand="kawasaki">
                <img src="https://via.placeholder.com/800x450?text=Kawasaki+Z650" alt="Kawasaki Z650" class="product-img">
                <div class="product-info">
                    <span class="product-brand">KAWASAKI</span>
                    <h3 class="product-name">Z900RS</h3>
                    <span class="product-price">售價 628,000 元</span>
                    <div class="product-specs"><span>948 cc</span> | <span>2023'2024</span></div>
                    <a href="booking-ride.html?model=Z900RS&brand=KAWASAKI" class="btn-view">預約賞車</a>
                </div>
            </div>

            <div class="product-card" data-brand="kawasaki">
                <img src="https://via.placeholder.com/800x450?text=Kawasaki+ZX-10R" alt="Kawasaki ZX-10R" class="product-img">
                <div class="product-info">
                    <span class="product-brand">KAWASAKI</span>
                    <h3 class="product-name">ZX-10R</h3>
                    <span class="product-price">售價 988,000 元</span>
                    <div class="product-specs"><span>998 cc</span> | <span>2025</span></div>
                    <a href="booking-ride.html?model=ZX-10R&brand=KAWASAKI" class="btn-view">預約賞車</a>
                </div>
            </div>

            <!-- KYMCO (光陽) 全車款 (常見清單) -->
            <div class="product-card" data-brand="kymco">
                <img src="https://via.placeholder.com/800x450?text=KYMCO+GP+125" alt="KYMCO GP 125" class="product-img">
                <div class="product-info">
                    <span class="product-brand">KYMCO</span>
                    <h3 class="product-name">GP 125</h3>
                    <span class="product-price">售價 78,800 元</span>
                    <div class="product-specs"><span>125 cc</span> | <span>2025</span></div>
                    <a href="booking-ride.html?model=GP%20125&brand=KYMCO" class="btn-view">預約賞車</a>
                </div>
            </div>

            <div class="product-card" data-brand="kymco">
                <img src="https://via.placeholder.com/800x450?text=KYMCO+Like+125" alt="KYMCO Like 125" class="product-img">
                <div class="product-info">
                    <span class="product-brand">KYMCO</span>
                    <h3 class="product-name">Like 125</h3>
                    <span class="product-price">售價 68,800 元</span>
                    <div class="product-specs"><span>125 cc</span> | <span>2025</span></div>
                    <a href="booking-ride.html?model=Like%20125&brand=KYMCO" class="btn-view">預約賞車</a>
                </div>
            </div>

            <div class="product-card" data-brand="kymco">
                <img src="https://via.placeholder.com/800x450?text=KYMCO+Many+125" alt="KYMCO Many 125" class="product-img">
                <div class="product-info">
                    <span class="product-brand">KYMCO</span>
                    <h3 class="product-name">Many 125</h3>
                    <span class="product-price">售價 59,800 元</span>
                    <div class="product-specs"><span>125 cc</span> | <span>2025</span></div>
                    <a href="booking-ride.html?model=Many%20125&brand=KYMCO" class="btn-view">預約賞車</a>
                </div>
            </div>

            <div class="product-card" data-brand="kymco">
                <img src="https://via.placeholder.com/800x450?text=KYMCO+Racing+S" alt="KYMCO Racing S" class="product-img">
                <div class="product-info">
                    <span class="product-brand">KYMCO</span>
                    <h3 class="product-name">Racing S</h3>
                    <span class="product-price">售價 89,800 元</span>
                    <div class="product-specs"><span>150 cc</span> | <span>2025</span></div>
                    <a href="booking-ride.html?model=Racing%20S&brand=KYMCO" class="btn-view">預約賞車</a>
                </div>
            </div>

            <div class="product-card" data-brand="kymco">
                <img src="https://via.placeholder.com/800x450?text=KYMCO+KRV+180" alt="KYMCO KRV 180" class="product-img">
                <div class="product-info">
                    <span class="product-brand">KYMCO</span>
                    <h3 class="product-name">KRV 180</h3>
                    <span class="product-price">售價 148,000 元</span>
                    <div class="product-specs"><span>180 cc</span> | <span>2025</span></div>
                    <a href="booking-ride.html?model=KRV%20180&brand=KYMCO" class="btn-view">預約賞車</a>
                </div>
            </div>

            <div class="product-card" data-brand="kymco">
                <img src="https://via.placeholder.com/800x450?text=KYMCO+Ionex" alt="KYMCO Ionex 系列" class="product-img">
                <div class="product-info">
                    <span class="product-brand">KYMCO</span>
                    <h3 class="product-name">Ionex 系列</h3>
                    <span class="product-price">售價 視車型而定</span>
                    <div class="product-specs"><span>電動</span> | <span>2025</span></div>
                    <a href="booking-ride.html?model=Ionex&brand=KYMCO" class="btn-view">預約賞車</a>
                </div>
            </div>

            <div class="product-card" data-brand="kymco">
                <img src="https://via.placeholder.com/800x450?text=KYMCO+AK+550" alt="KYMCO AK 550" class="product-img">
                <div class="product-info">
                    <span class="product-brand">KYMCO</span>
                    <h3 class="product-name">AK 550</h3>
                    <span class="product-price">售價 368,000 元</span>
                    <div class="product-specs"><span>550 cc</span> | <span>2025</span></div>
                    <a href="booking-ride.html?model=AK%20550&brand=KYMCO" class="btn-view">預約賞車</a>
                </div>
            </div>
        </div>

        <!-- 動態二手車展示區（由 localStorage.formSubmissions 的 type === 'inventory' 動態生成） -->
        <div class="product-grid" id="bikeGrid">
            <!-- 二手車將在此由 loadInventoryFromLocalStorage() 產生 -->
        </div>
    </main>

    <section class="footer-info">
            <div class="footer-container">
                <div class="footer-column">
                    <h4>服務項目</h4>
                    <ul>
                        <li><a href="index.html">關於我們</a></li>
                        <li><a href="products.html">現車庫存</a></li>
                        <li><a href="booking-ride.html">預約試乘</a></li>
                        <li><a href="booking-service.html">預約保養</a></li>
                        <li><a href="event-signup.html">活動報名</a></li>
                    </ul>
                </div>
                <div class="footer-column">
                    <h4>門市位置</h4>
                    <p>高雄市三民區九如二路 575 號</p>
                    <a href="https://www.google.com/maps/dir/?api=1&destination=明德車業有限公司" 
                    target="_blank" class="nav-link">
                    ➤ 開啟 Google 導航
                    </a>
                </div>
                <div class="footer-column">
                    <h4>營業時間</h4>
                    <p>週一至週五：09:30 – 20:30</p>
                    <p>週六：09:30 – 18:00 (隔週休)</p>
                    <p style="color: #ff4d4d; font-weight: bold;">週日：休息</p>
                </div>
                <div class="footer-column">
                    <h4 style="margin-bottom: 20px;">聯絡資訊</h4>
                    <p>Tel: <a href="tel:073111111" class="footer-link">07-311-1111</a></p>
                    <p>FB: <a href="https://www.facebook.com/MingDeCheYeYouXianGongSi/?locale=zh_TW" target="_blank" class="footer-link">明德車業有限公司</a></p>
                    <p>Gmail: <a href="mailto:kawasaki9750@gmail.com" class="footer-link">kawasaki9750@gmail.com</a></p>
                    <p>Line@: <a href="https://line.me/R/ti/p/@mdmotors" target="_blank" class="footer-link">@mdmotors</a></p>
                </div>
            </div>
        </section>
        
    <script>
        // Load mobile menu script after the page has loaded
        window.addEventListener('load', function() {
            const script = document.createElement('script');
            script.src = 'js/mobile-menu.js';
            document.body.appendChild(script);
        });

        function filterBikes(brand, event) {
            // 防止事件冒泡
            if (event) {
                event.preventDefault();
                event.stopPropagation();
            }

            // 切換按鈕樣式
            const btns = document.querySelectorAll('.filter-btn');
            btns.forEach(btn => btn.classList.remove('active'));
            
            // 添加active類到當前點擊的按鈕
            const target = event ? event.currentTarget : document.querySelector(`.filter-btn[onclick*="${brand}"]`);
            target.classList.add('active');

            // 執行篩選邏輯
            const cards = document.querySelectorAll('.product-card');
            cards.forEach(card => {
                const cardBrand = card.getAttribute('data-brand');
                if (brand === 'all' || 
                    (brand === 'used' && card.classList.contains('used')) ||
                    (brand !== 'used' && cardBrand === brand && !card.classList.contains('used'))) {
                    card.style.display = 'block';
                } else {
                    card.style.display = 'none';
                }
            });
        }

        // 頁面加載時顯示所有產品
        document.addEventListener('DOMContentLoaded', function() {
            filterBikes('all');
            // 載入來自後台的現車庫存
            loadInventoryFromLocalStorage();
        });

        function loadInventoryFromLocalStorage() {
            const grid = document.getElementById('bikeGrid');
            if (!grid) return;
            // 先清空現有
            // 注意：filterBikes 會操作 .product-card，因此先清空再生成
            grid.innerHTML = '';
            const submissions = JSON.parse(localStorage.getItem('formSubmissions') || '[]');
            const inventories = submissions.filter(s => s && s.type === 'inventory');
            if (!inventories || inventories.length === 0) {
                const empty = document.createElement('div');
                empty.className = 'text-center';
                empty.style.padding = '40px';
                grid.appendChild(empty);
                return;
            }

            inventories.forEach(item => {
                const card = document.createElement('div');
                card.className = 'product-card';
                const brand = (item.brand || item.model || '其他').toString();
                card.setAttribute('data-brand', brand.toLowerCase());
                if (item.used) card.classList.add('used');

                const imgSrc = item.image || 'https://via.placeholder.com/800x450?text=No+Image';
                const priceText = item.price ? `售價 ${Number(item.price).toLocaleString()} 元` : '價格未定';
                const specs = [];
                if (item.year) specs.push(item.year);
                if (item.color) specs.push(item.color);
                if (item.mileage) specs.push(item.mileage + (isNaN(item.mileage) ? '' : ' km'));

                card.innerHTML = `
                    <img src="${imgSrc}" alt="${item.model || '車款'}" class="product-img">
                    <div class="product-info">
                        <span class="product-brand">${brand.toUpperCase()}</span>
                        <h3 class="product-name">${item.model || '未命名車款'}</h3>
                        <span class="product-price">${priceText}</span>
                        <div class="product-specs">${specs.map(s=>`<span>${s}</span>`).join(' | ')}</div>
                        <a href="booking-ride.html?model=${encodeURIComponent(item.model||'')}&brand=${encodeURIComponent(brand)}" class="btn-view">預約賞車</a>
                    </div>
                `;

                grid.appendChild(card);
            });
        }
    </script>
    <script src="js/mobile-menu.js"></script>
</body>
</html>